{"ast":null,"code":"import _slicedToArray from\"/Users/angrandy/Desktop/csc3007_assignment01/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import{useEffect,useState}from\"react\";import\"./table.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function UseFetch(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var url=\"https://api.data.gov.sg/v1/environment/psi\";var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),headers=_useState8[0],setHeaders=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),lastUpdate=_useState10[0],setLastUpdate=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),headersHtml=_useState12[0],setHeadersHtml=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),rowsHtml=_useState14[0],setRowsHtml=_useState14[1];var headersHtmlArray=[];var rowsHtmlArray=[];useEffect(function(){fetch(url).then(function(json){return json.json();}).then(function(res){var date=new Date(res.items[0].update_timestamp);var mins=('0'+date.getMinutes()).slice(-2);var months=date.toLocaleString('default',{month:'short'});setLastUpdate(date.getDay().toString()+\" \"+months+\" \"+date.getFullYear().toString()+\", \"+date.getHours()+\":\"+mins);setData(res.items[0].readings);setLoading(false);}).catch(function(error){return setError(error);});},[]);useEffect(function(){rowsHtmlArray=[];Object.keys(data).forEach(function(key){rowsHtmlArray.push(/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:key}),/*#__PURE__*/_jsx(\"td\",{children:data[key].national}),/*#__PURE__*/_jsx(\"td\",{children:data[key].central}),/*#__PURE__*/_jsx(\"td\",{children:data[key].west}),/*#__PURE__*/_jsx(\"td\",{children:data[key].east}),/*#__PURE__*/_jsx(\"td\",{children:data[key].north}),/*#__PURE__*/_jsx(\"td\",{children:data[key].south})]}));});if(Object.keys(data).length>0){setHeaders(Object.keys(Object.values(data)[0]));}headersHtmlArray=[];headersHtmlArray.push(/*#__PURE__*/_jsx(\"th\",{children:\"metric\"}));for(var i in headers){headersHtmlArray.push(/*#__PURE__*/_jsx(\"th\",{children:headers[i]}));}setHeadersHtml(headersHtmlArray);setRowsHtml(rowsHtmlArray);},[data]);if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"loading\"});if(error)return/*#__PURE__*/_jsx(\"div\",{children:\"error\"});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Last updated \",lastUpdate,\" \"]}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:headersHtml})}),/*#__PURE__*/_jsx(\"tbody\",{children:rowsHtml})]})]});}","map":{"version":3,"names":["React","useEffect","useState","UseFetch","data","setData","url","loading","setLoading","error","setError","headers","setHeaders","lastUpdate","setLastUpdate","headersHtml","setHeadersHtml","rowsHtml","setRowsHtml","headersHtmlArray","rowsHtmlArray","fetch","then","json","res","date","Date","items","update_timestamp","mins","getMinutes","slice","months","toLocaleString","month","getDay","toString","getFullYear","getHours","readings","catch","Object","keys","forEach","key","push","national","central","west","east","north","south","length","values","i"],"sources":["/Users/angrandy/Desktop/csc3007_assignment01/src/useFetch.js"],"sourcesContent":["import React from \"react\";\nimport { useEffect, useState } from \"react\";\nimport \"./table.css\"\n\nexport default function UseFetch() {\n  const [data, setData] = useState({});\n\n  const url = \"https://api.data.gov.sg/v1/environment/psi\";\n\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState()\n  \n  const [headers, setHeaders] = useState([])\n  const [lastUpdate, setLastUpdate] = useState()\n\n  const [headersHtml, setHeadersHtml] = useState([])\n  const [rowsHtml, setRowsHtml] = useState([])\n  let headersHtmlArray = []\n  let rowsHtmlArray = []\n\n  useEffect(() => {\n    fetch(url)\n    .then((json) => json.json())\n    .then((res) => {\n      let date = new Date(res.items[0].update_timestamp)\n      let mins = ('0'+date.getMinutes()).slice(-2)\n      let months = date.toLocaleString('default', { month: 'short' });\n      setLastUpdate(date.getDay().toString()+\" \"+months+\" \"+date.getFullYear().toString()+\", \"+date.getHours()+\":\"+mins)\n      setData(res.items[0].readings)\n      setLoading(false)\n    }).catch(error => setError(error))\n  }, []);\n\n  useEffect(() => {\n    rowsHtmlArray = []\n    Object.keys(data).forEach((key) => {\n      rowsHtmlArray.push(\n        <tr>\n          <td>{key}</td>\n          <td>{data[key].national}</td>\n          <td>{data[key].central}</td>\n          <td>{data[key].west}</td>\n          <td>{data[key].east}</td>\n          <td>{data[key].north}</td>\n          <td>{data[key].south}</td>\n        </tr>\n      )\n    })\n\n    if (Object.keys(data).length > 0) {\n      setHeaders(Object.keys(Object.values(data)[0]))\n    }\n    \n    headersHtmlArray = []\n    headersHtmlArray.push(<th>metric</th>)\n    for (const i in headers) {\n      headersHtmlArray.push(<th>{headers[i]}</th>)\n    }\n\n    setHeadersHtml(headersHtmlArray)\n    setRowsHtml(rowsHtmlArray)\n  }, [data])\n\n  if (loading) return <div>loading</div>\n\n  if (error) return <div>error</div>\n\n  return (\n    <div>\n      <h4>Last updated {lastUpdate} </h4>\n        <table>\n        <thead>\n          <tr>\n            {headersHtml}\n          </tr>\n        </thead>\n        <tbody>\n          {rowsHtml}\n        </tbody>\n      </table>\n    </div>\n  )  \n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}